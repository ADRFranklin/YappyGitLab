<html>
<head>
</head>
<body style="background: transparent;">
    <script src="scripts/docstrap.lib.js"></script>
    <script src="scripts/lunr.min.js"></script>
    <script src="scripts/fulltext-search.js"></script>

    <script type="text/x-docstrap-searchdb">
    {"Models_ChannelConfig.js.html":{"id":"Models_ChannelConfig.js.html","title":"Source: Models/ChannelConfig.js","body":" Yappy, the Gitlab Monitor Classes ChannelConfigChannelConfigItemGitlabUtil Global Global Source: Models/ChannelConfig.js const mongoose = require('mongoose'); const Collection = require('discord.js').Collection; const Schema = mongoose.Schema; let channelConfigSchema = Schema({ guildName: String, guildId: String, channelName: String, channelId: String, prefix: String, repos: Array, disabledEvents: { type: Array, default: [ 'merge_request/update', ], }, }); let channelConfig = mongoose.model('ChannelConfig', channelConfigSchema); /** * A Channel Config Item */ class ChannelConfigItem { constructor(client, config) { /** * The bot client * @type Client * @private */ this._client = client; for (let key in config) { if (config.hasOwnProperty(key)) { this[key] = config[key]; } } } /** * Set a specific config property to a value for this config item * @param {String} prop Property to modify * @param {String} value The new value for the property * @see ChannelConfig#SetChannel * @return {Promise} */ set(prop, value) { return this._client.SetChannel(this.channelId, prop, value); } /** * Delete repo events from channel * @param {String} repo Repo events to delete from channel */ deleteRepo(repo) { let repos = this.repos; repos.splice(repos.indexOf(repo), 1); return this.set('repos', repos); } } /** * The Channel Config manager */ class ChannelConfig { constructor() { /** * All the config * @type {Collection} * @private */ this._data = new Collection(); this.setup(); } /** * Get config from database and add to this._data */ setup() { channelConfig.find({}).then(configs =&gt; { configs.forEach(row =&gt; { this._data.set(row.channelId, new ChannelConfigItem(this, row._doc)); }); }); } init(bot) { for (const ch of bot.channels) { const channel = ch[1]; if (!channel || channel.type !== 'text') continue; if (!this.FindByChannel(channel.id)) { Log.info(`ChannelConf | Adding &quot;${channel.guild.name}&quot;'s #${channel.name} (${channel.id})`); this.AddChannel(channel).catch(e =&gt; bot.emit('error', e)); } } bot.on('channelDelete', channel =&gt; { if (!channel || channel.type !== 'text') return; Log.info(`ChannelConf | Deleting &quot;${channel.guild.name}&quot;'s #${channel.name} (${channel.id})`); this.DeleteChannel(channel.id); }); bot.on('channelCreate', channel =&gt; { if (!channel || channel.type !== 'text') return; let ch = this.FindByChannel(channel.id); if (ch) return; Log.info(`ChannelConf | Adding &quot;${channel.guild.name}&quot;'s #${channel.name} (${channel.id})`); this.AddChannel(channel); }); } /** * Find channels with events for repo * @param {String} repo Repo for the events * @return {ChannelConfigItem} */ FindByRepo(repo) { let re = repo.toLowerCase(); return this._data.filter(e =&gt; e.repos.filter(r =&gt; r === re)[0]); } /** * Find events for channel * @param {String} channel Channel (ID) with the events * @return {ChannelConfigItem} */ FindByChannel(channel) { return this._data.find('channelId', channel); } /** * Find channels with events for repo * @param {String} channel Channel (ID) with the repo's events * @param {String} repo Repo to check in channel * @return {ChannelConfigItem} */ FindRepoInChannel(channel, repo) { return this._data.find(e =&gt; e.channelId = channel &amp;&amp; e.repos.includes(repo)); } /** * Delete all repo events from channel * @param {String} channel Channel with the events to delete * @return {ChannelConfig} */ DeleteChannel(channel) { return channelConfig.findOneAndRemove({ channelId: channel, }).then(() =&gt; { let oldData = this._data; let newData = oldData.filter(e =&gt; e.channel !== channel); this._data = newData; return Promise.resolve(this); }); } /** * Delete repo events from specific channel * @param {String} channel Channel with the repo events * @param {String} repo Repo event to remove from Channel * @return {ChannelConfig} */ DeleteRepo(channel, repo) { return channelConfig.findOneAndRemove({ repo, }).then(() =&gt; { let oldRepos = this._data.find('channelId', channel); let newRepos = oldRepos.slice(0, oldRepos.indexOf(repo)); return this.SetChannel(channel, 'repos', newRepos); }); } /** * Delete repo events from specific channel * @param {String} channel Channel with the repo events * @param {String} repo Repo event to remove from Channel * @return {ChannelConfig} */ SetChannel(channel, prop, value) { return new Promise((resolve, reject) =&gt; { let oldConfig = this._data.find('channelId', channel); let newConfig = oldConfig; newConfig[prop] = value; channelConfig.findOneAndUpdate({ channelId: channel, }, newConfig, { new: true, }, (err) =&gt; { if (err) return reject(err); this._data.set(newConfig.channel, new ChannelConfigItem(this, newConfig)); resolve(newConfig); }); }); } AddChannel(channel) { if (!channel || !channel.id) return Promise.reject(`No channel passed!`); if (channel &amp;&amp; channel.id &amp;&amp; this.FindByChannel(channel.id)) return Promise.reject(`Channel already has an entry in database`); let conf = { guildId: channel.guild &amp;&amp; channel.guild.id, guildName: channel.guild &amp;&amp; channel.guild.name, channelId: channel.id, channelName: channel.name, repos: [], prefix: `GL! `, disabledEvents: [], }; return channelConfig.create(conf).then(() =&gt; { this._data.set(conf.channelId, new ChannelConfigItem(this, conf)); return Promise.resolve(this); }); } async AddRepoToChannel(channel, repo) { if (!channel || !repo) return Promise.reject(`Invalid arguments.`); let conf = this.FindByChannel(channel); let repos = conf.repos; repos.push(repo.toLowerCase()); return this.SetChannel(channel, 'repos', repos); } } /** * The channel config Schema * @type ChannelConfigItem * @typedef {Object} ChannelConfigSchema * @property {String} guildName Guild Name * @property {String} guildId Guild Id * @property {String} channelName Channel Name * @property {String} channelId Channel Id * @property {Array} repos Array of repos to event to channel (channelId) * @property {Array} disabledEvents Github events to disable in this channel */ module.exports = new ChannelConfig(); × Search results Close "},"Gitlab_index.js.html":{"id":"Gitlab_index.js.html","title":"Source: Gitlab/index.js","body":" Yappy, the Gitlab Monitor Classes ChannelConfigChannelConfigItemGitlabUtil Global Global Source: Gitlab/index.js const GitlabAPI = require('node-gitlab'); const EventHandler = require('./EventHandler'); const GitlabRepoParse = require('./GitlabRepoParser').Parse; /** * Gitlab class with custom helper methods, logs in immediatly if token is found */ class Gitlab { constructor() { Log.info(`GitLab | Logging in...`); if (process.env.GITLAB_TOKEN) { this.gitlab = GitlabAPI.createPromise({ api: 'https://gitlab.com/api/v3', token: process.env.GITLAB_TOKEN, }); Log.info(`GitLab | Logged in!`); EventHandler.setGitlab(this.gitlab); } else { Log.warn(`GitLab | No token provided! Skipped login.`); } } /** * Get GitLab repository information * @param {String} ownerOrId - Repo's owner or full repository name/url * @param {String} [name] - Repo's name, required if ownerOrId is repo's owner * @return {Promise} */ async getRepo(ownerOrId, name) { let repo = name &amp;&amp; GitlabRepoParse(`${ownerOrId}/${name}`); let repoId = repo ? repo.repo.replace(/\\//g, '%2F') : ownerOrId; if (!this.gitlab) { Log.warn(`GitLab | getRepo: returning sample gitlab project`); return Promise.resolve({ id: 101, description: 'awful project', default_branch: 'master', public: true, web_url: 'http://gitlab.com/awful/project', owner: { id: 100, name: 'Awful', }, name: 'Project', name_with_namespace: 'Awful / Project', path: 'project', path_with_namespace: 'awful/project', }); } else { return this.gitlab.projects.get({ id: repoId }); } } } module.exports = new Gitlab(); × Search results Close "},"Util_index.js.html":{"id":"Util_index.js.html","title":"Source: Util/index.js","body":" Yappy, the Gitlab Monitor Classes ChannelConfigChannelConfigItemGitlabUtil Global Global Source: Util/index.js const Pad = require('./Pad'); const MergeDefault = require('./MergeDefault'); /** * Some utilities :) */ class Util { /** * Add padding to the right of a string * @param {String} string - The string to pad * @param {Integer} length - Length of final string * @return {String} The string with padding on the right */ Pad(...args) { return Pad(...args); } /** * Merge an object with a defaults object * @param {Object} def Default * @param {Object} given Object given to merge with default * @return {Object} Merged object */ MergeDefault(...args) { return MergeDefault(...args); } } module.exports = new Util(); × Search results Close "},"global.html":{"id":"global.html","title":"Global","body":" Yappy, the Gitlab Monitor Classes ChannelConfigChannelConfigItemGitlabUtil Global Global Global Type Definitions ChannelConfigSchema The channel config Schema Type: ChannelConfigItem Properties: Name Type Description guildName String Guild Name guildId String Guild Id channelName String Channel Name channelId String Channel Id repos Array Array of repos to event to channel (channelId) disabledEvents Array Github events to disable in this channel Source: Models/ChannelConfig.js, line 209 × Search results Close "},"classes.list.html":{"id":"classes.list.html","title":"Classes","body":" Yappy, the Gitlab Monitor Classes ChannelConfigChannelConfigItemGitlabUtil Global Global Classes Classes ChannelConfig ChannelConfigItem Gitlab Util × Search results Close "},"index.html":{"id":"index.html","title":"Index","body":" Yappy, the Gitlab Monitor Classes ChannelConfigChannelConfigItemGitlabUtil Global Global DiscordBot-YappyGitlab 1.0.0 Yappy, the GitLab MonitorWORK IN PROGRESS Monitor your GitLab repos by adding this bot to your server, set up a channel for it, and don't miss any events! HelpJoin our Discord server at https://discord.gg/HHqndMG × Search results Close "},"ChannelConfig.html":{"id":"ChannelConfig.html","title":"Class: ChannelConfig","body":" Yappy, the Gitlab Monitor Classes ChannelConfigChannelConfigItemGitlabUtil Global Global Class: ChannelConfig ChannelConfig The Channel Config manager new ChannelConfig() Source: Models/ChannelConfig.js, line 63 Members &lt;private&gt; _data :Collection All the config Type: Collection Source: Models/ChannelConfig.js, line 70 Methods DeleteChannel(channel) Delete all repo events from channel Parameters: Name Type Description channel String Channel with the events to delete Source: Models/ChannelConfig.js, line 136 Returns: Type ChannelConfig DeleteRepo(channel, repo) Delete repo events from specific channel Parameters: Name Type Description channel String Channel with the repo events repo String Repo event to remove from Channel Source: Models/ChannelConfig.js, line 152 Returns: Type ChannelConfig FindByChannel(channel) Find events for channel Parameters: Name Type Description channel String Channel (ID) with the events Source: Models/ChannelConfig.js, line 119 Returns: Type ChannelConfigItem FindByRepo(repo) Find channels with events for repo Parameters: Name Type Description repo String Repo for the events Source: Models/ChannelConfig.js, line 110 Returns: Type ChannelConfigItem FindRepoInChannel(channel, repo) Find channels with events for repo Parameters: Name Type Description channel String Channel (ID) with the repo's events repo String Repo to check in channel Source: Models/ChannelConfig.js, line 128 Returns: Type ChannelConfigItem SetChannel(channel, repo) Delete repo events from specific channel Parameters: Name Type Description channel String Channel with the repo events repo String Repo event to remove from Channel Source: Models/ChannelConfig.js, line 167 Returns: Type ChannelConfig setup() Get config from database and add to this._data Source: Models/ChannelConfig.js, line 76 × Search results Close "},"ChannelConfigItem.html":{"id":"ChannelConfigItem.html","title":"Class: ChannelConfigItem","body":" Yappy, the Gitlab Monitor Classes ChannelConfigChannelConfigItemGitlabUtil Global Global Class: ChannelConfigItem ChannelConfigItem A Channel Config Item new ChannelConfigItem() Source: Models/ChannelConfig.js, line 25 Members &lt;private&gt; _client :Client The bot client Type: Client Source: Models/ChannelConfig.js, line 32 Methods deleteRepo(repo) Delete repo events from channel Parameters: Name Type Description repo String Repo events to delete from channel Source: Models/ChannelConfig.js, line 53 set(prop, value) Set a specific config property to a value for this config item Parameters: Name Type Description prop String Property to modify value String The new value for the property Source: Models/ChannelConfig.js, line 46 See: ChannelConfig#SetChannel Returns: Type Promise × Search results Close "},"Gitlab.html":{"id":"Gitlab.html","title":"Class: Gitlab","body":" Yappy, the Gitlab Monitor Classes ChannelConfigChannelConfigItemGitlabUtil Global Global Class: Gitlab Gitlab Gitlab class with custom helper methods, logs in immediatly if token is found new Gitlab() Source: Gitlab/index.js, line 8 Methods getRepo(ownerOrId [, name]) Get GitLab repository information Parameters: Name Type Argument Description ownerOrId String Repo's owner or full repository name/url name String &lt;optional&gt; Repo's name, required if ownerOrId is repo's owner Source: Gitlab/index.js, line 28 Returns: Type Promise × Search results Close "},"Util.html":{"id":"Util.html","title":"Class: Util","body":" Yappy, the Gitlab Monitor Classes ChannelConfigChannelConfigItemGitlabUtil Global Global Class: Util Util Some utilities :) new Util() Source: Util/index.js, line 7 Methods MergeDefault(def, given) Merge an object with a defaults object Parameters: Name Type Description def Object Default given Object Object given to merge with default Source: Util/index.js, line 23 Returns: Merged object Type Object Pad(string, length) Add padding to the right of a string Parameters: Name Type Description string String The string to pad length Integer Length of final string Source: Util/index.js, line 14 Returns: The string with padding on the right Type String × Search results Close "}}
    </script>

    <script type="text/javascript">
        $(document).ready(function() {
            Searcher.init();
        });

        $(window).on("message", function(msg) {
            var msgData = msg.originalEvent.data;

            if (msgData.msgid != "docstrap.quicksearch.start") {
                return;
            }

            var results = Searcher.search(msgData.searchTerms);

            window.parent.postMessage({"results": results, "msgid": "docstrap.quicksearch.done"}, "*");
        });
    </script>
</body>
</html>
